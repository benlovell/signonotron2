<h1 class="add-big-bottom-margin">Set up 2-step verification</h1>
<div class="panel panel-default" style="max-width: 700px">
<% # TODO two_step_setup_index_path goes to create!?!!?!? %>
  <%= form_tag two_step_setup_path do |f| %>
    <div class="panel-body">
      <p class="lead">2-step verification adds another layer of security to your account. You’ll need to use an app on your phone to generate a code to enter when you sign in.</p>
      <hr />

      <h3>1. Get a verification app</h3>
      <p>Download one of the following apps to your phone.</p>
      <ul>
        <li>
          <h4 class="remove-bottom-margin"><a href="#">Google Authenticator</a></h4>
          <span class="text-muted">iOS, Android, Blackberry</span>
        </li>
        <li>
          <h4 class="remove-bottom-margin"><a href="#">Duo Mobile</a></h4>
          <span class="text-muted">iOS, Android</span>
        </li>
        <li>
          <h4 class="remove-bottom-margin"><a href="#">Windows Phone Authenticator</a></h4>
        </li>
      </ul>
      <hr />

      <h3>2. Set up the app on your phone</h3>
      <div class="row add-top-margin">
        <div class="col-md-8"><p>Open your 2-step verification app and add Sign on by scanning the QR code.</p>
        <p><a href="javascript:alert('<%= current_user.otp_secret_key %>')">Set up without using a QR code</a></p></div>

        <div class="col-md-3"><%= current_user.provisioning_uri %></div>
      </div>
      <hr />

      <h3>3. Enter your verification code</h3>
      <p>Your phone will now generate a verification code which you’ll need to use to sign in.</p>
      <div class="well remove-bottom-margin add-top-margin">
      <% # should we cryptographically sign the secret key? %>
        <%= hidden_field_tag :otp_secret_key, current_user.otp_secret_key %>
        <div class="form-group">
          <label>
            Verification code<br />
            <span class="text-muted normal">Enter the code generated by your app</span>
          </label>
          <input name="code" type="text" class="form-control input-md-4 input-lg" placeholder="Enter 6 digit code"/>
        </div>
      </div>
    </div>
    <div class="panel-footer">
      <input type="submit" class="btn btn-lg btn-success" value="Turn on 2-step verification">
      <a href="/" class="btn btn-lg btn-default add-left-margin">Cancel</a>
    </div>
  <% end %>
</div>
<div style="height: 400px"></div>
